<!DOCTYPE html>
<html lang="en">
  <%- include("../partials/head", { title: "মনোবন্ধু - AI Chat Companion" }) %>
  <body class="bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 min-h-screen text-gray-100 flex flex-col">
    <%- include("../partials/navbar") %>

    <div class="max-w-3xl mx-auto mt-10 p-6 bg-blue-800/50 backdrop-blur-sm rounded-2xl card-shadow border border-blue-600/30">
      <h2 class="text-2xl font-bold text-yellow-400 mb-4 text-center">
        মনোবন্ধুকে লিখে দিন আপনার যাবতীয় সমস্যা
      </h2>

      <div
        id="chatBox"
        class="h-96 overflow-y-auto border border-blue-600/30 p-4 rounded-xl bg-blue-900/30 mb-4"
      ></div>

      <form id="chatForm" class="flex space-x-2">
        <input
          type="text"
          id="userInput"
          name="message"
          placeholder="এখানে লিখুন"
          class="flex-1 bg-blue-900/50 border border-blue-600/30 p-3 rounded-xl text-gray-100 placeholder-blue-300 focus:border-yellow-500/50 focus:outline-none"
          required
        />
        <button
          type="submit"
          class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-gray-900 px-6 py-3 rounded-xl font-bold hover:from-yellow-400 hover:to-yellow-500 transition transform hover:scale-105 card-shadow border border-yellow-400"
        >
          উত্তর পান
        </button>
      </form>
    </div>

    <script>
      const chatBox = document.getElementById("chatBox");
      const chatForm = document.getElementById("chatForm");
      const userInput = document.getElementById("userInput");

      chatForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const message = userInput.value.trim();
        if (!message) return;

        chatBox.innerHTML += `<div class='text-right text-yellow-400 my-2'><b>You:</b> ${message}</div>`;
        userInput.value = "";

        const res = await fetch("/dashboard/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message }),
        });

        const data = await res.json();
        chatBox.innerHTML += `<div class='text-left text-blue-200 my-2'><b>AI:</b> ${data.reply}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
      });
    </script>

    <style>
      .card-shadow { 
        box-shadow: 0 12px 30px rgba(14, 12, 26, 0.5); 
      }
    </style>
  </body>
</html>
