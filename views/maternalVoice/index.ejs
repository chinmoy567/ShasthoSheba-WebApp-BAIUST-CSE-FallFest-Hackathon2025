<!DOCTYPE html>
<html lang="bn">
  <%- include('../partials/head', { title: 'ЁЯОд ржорж╛рждрзГ ржУ рж╢рж┐рж╢рзБрж░ ржнрзЯрзЗрж╕ ржЯрзНрж░рзНржпрж╛ржХрж╛рж░' }) %>
  <body class="bg-gray-100 font-[Inter]">
    <div class="max-w-2xl mx-auto mt-12 bg-white p-8 shadow-xl rounded-2xl text-center">
      <h1 class="text-2xl font-bold text-indigo-600 mb-4">
        ЁЯОд ржорж╛рждрзГ ржУ рж╢рж┐рж╢рзБрж░ рж╕рзНржмрж╛рж╕рзНржерзНржп ржЯрзНрж░рзНржпрж╛ржХрж╛рж░ (Voice Input)
      </h1>
      <p class="text-gray-600 mb-4">
        ржмрж▓рзБржи ржмрж╛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи: тАЬржЖржорж┐ ржЧрж░рзНржнржмрждрзАтАЭ ржЕржержмрж╛ тАЬржЖржорж╛рж░ рж╢рж┐рж╢рзБрж░ ржЬржирзНржо рждрж╛рж░рж┐ржЦ рзз ржЬрж╛ржирзБрзЯрж╛рж░рж┐ рзирзжрзирзлтАЭ
      </p>

      <form action="/dashboard/maternalvoice" method="POST" id="maternalForm" class="space-y-4">
        <select name="type" class="w-full border px-4 py-2 rounded-md" required>
          <option value="mother">ржЧрж░рзНржнржмрждрзА ржорж╛</option>
          <option value="child">рж╢рж┐рж╢рзБ</option>
        </select>

        <input type="date" name="date" id="dateInput" required class="w-full border px-4 py-2 rounded-md" />

        <button type="submit" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 w-full">
          ЁЯЧУя╕П рж╕ржорзЯрж╕рзВржЪрж┐ рждрзИрж░рж┐ ржХрж░рзБржи
        </button>
      </form>

      <div class="mt-6">
        <button
          id="voiceBtn"
          class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg text-lg"
        >
          ЁЯОЩя╕П ржмрж▓рзБржи
        </button>
        <p id="voiceResult" class="mt-4 text-gray-700"></p>
      </div>
    </div>

    <script>
      const voiceBtn = document.getElementById("voiceBtn");
      const voiceResult = document.getElementById("voiceResult");
      const dateInput = document.getElementById("dateInput");

      if ("webkitSpeechRecognition" in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = "bn-BD";
        recognition.continuous = false;
        recognition.interimResults = false;

        voiceBtn.addEventListener("click", () => {
          recognition.start();
          voiceResult.textContent = "ЁЯОз рж╢рзБржиржЫрж┐...";
        });

        recognition.onresult = (event) => {
          const result = event.results[0][0].transcript;
          voiceResult.textContent = "ржЖржкржирж┐ ржмрж▓рж▓рзЗржи: " + result;

          const match = result.match(/\d{1,2}\s*[ржП|ржЗ]*\s*[ржЬрж╛ржирзБржпрж╝рж╛рж░рж┐|ржлрзЗржмрзНрж░рзБржпрж╝рж╛рж░рж┐|ржорж╛рж░рзНржЪ|ржПржкрзНрж░рж┐рж▓|ржорзЗ|ржЬрзБржи|ржЬрзБрж▓рж╛ржЗ|ржЖржЧрж╕рзНржЯ|рж╕рзЗржкрзНржЯрзЗржорзНржмрж░|ржЕржХрзНржЯрзЛржмрж░|ржиржнрзЗржорзНржмрж░|ржбрж┐рж╕рзЗржорзНржмрж░]\s*\d{4}/);
          if (match) {
            alert("рждрж╛рж░рж┐ржЦ рж╢ржирж╛ржХрзНржд ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ: " + match[0]);
          }
        };
      } else {
        voiceResult.textContent = "тЭМ ржЖржкржирж╛рж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржнрзЯрзЗрж╕ рж╕рж╛ржкрзЛрж░рзНржЯ ржирзЗржЗред";
      }
    </script>
  </body>
</html>
